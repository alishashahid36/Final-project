(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8966],{92027:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/presentations/file/[presentationId]",function(){return n(35707)}])},60514:function(e,t,n){"use strict";n.d(t,{y:function(){return a}});var r=n(85893),o=n(23100),i=n(7128),l=n(64416);n(67294);var s=n(36302);let a=e=>{let{dataItem:t,isEnableCopy:n=!1,actionIsImagePreview:a=!0,activeOpenId:c,activeStyle:d={}}=e;return(0,r.jsx)(r.Fragment,{children:t.pageList.map((e,u)=>(0,r.jsx)(o.xu,{w:"full",children:(0,r.jsx)(o.xu,{"data-body":e.openId,rounded:"8px",...e.openId===c?d:{},overflow:"hidden",children:t.pageMode===l.nh?(0,r.jsx)(s.N,{item:{...e,actionIsImagePreview:a},themeSetting:t.themeSetting,isEnableCopy:n}):(0,r.jsx)(i.E,{boxSize:"full",src:e.imageUrl,alt:e.title})})},e.openId))})}},93173:function(e,t,n){"use strict";n.d(t,{R:function(){return i}});var r=n(67294),o=n(90682);let i=e=>{let[t]=(0,o.q)(e=>[e.isLogin]);return(0,r.useEffect)(()=>{void 0!==t&&e&&e(t)},[t]),{isLogin:t}}},35707:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var r=n(85893),o=n(23100),i=n(67294),l=n(31855),s=n(9008),a=n.n(s),c=n(11163),d=n(32243),u=n(93056),x=n(93173),p=n(4527),h=n(54141);n(31742),n(58282);var f=n(25233),m=n(27973),g=n(61120),y=n.n(g),b=n(85734),v=n(204),j=n(295),w=n(29222),S=n(49598),k=n(7754),E=n(16393),I=n(60514),C=n(24067),M=n(47516),_=n(64416);let L=!1,F=e=>{let{dataItem:t,setDataItem:n}=e,[s,a]=(0,i.useState)([50,50]),u=(0,c.useRouter)(),x=(0,i.useRef)(null),[g,F]=(0,i.useState)(!1),T=(0,i.useRef)({x:0,y:0}),[N,R]=(0,i.useState)(!1);(0,i.useEffect)(()=>{g&&Promise.resolve().then(()=>{var e;null===(e=x.current)||void 0===e||e.scrollTo({top:1e5,left:0,behavior:"smooth"})})},[g]);let U=(0,i.useCallback)(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(g)return;let o={createMode:r};"text"===o.createMode&&(o.inputText=e),"image"===o.createMode&&(o.inputFileUuid=e),F(!0);let i=await (0,l.U4)({param:{openId:u.query.presentationId},body:{...o},query:{createMode:o.createMode}});if(F(!1),i.error){console.error(i.error);return}t.pageList=[...t.pageList,i.data.page],n(t)},[t,g,u.query.presentationId,n]),z=(0,i.useCallback)(()=>{let e=window.getSelection(),t=document.getElementById("selection-context-menu"),n=document.querySelector(".pdf-viwer");if(!n||!t)return;if(L||!e||0===e.rangeCount||e.toString().trim().length<2){t.style.visibility="hidden";return}let r=e.getRangeAt(0),o=r.commonAncestorContainer;if(o.nodeType===Node.TEXT_NODE&&(o=o.parentNode),!(o instanceof Element&&null!=o.closest(".rpv-core__inner-container"))){t.style.visibility="hidden";return}let i=r.getBoundingClientRect();if(i.top>n.offsetHeight||i.bottom<0){t.style.visibility="hidden";return}t.style.left="".concat(T.current.x,"px"),t.style.top="".concat(T.current.y,"px"),t.style.visibility="visible"},[]),D=(0,i.useCallback)(e=>{L=!0,z()},[]),q=(0,i.useCallback)(e=>{L=!1,T.current.x=e.clientX,T.current.y=e.clientY,z()},[]);(0,i.useEffect)(()=>(document.addEventListener("selectionchange",z),document.addEventListener("mousedown",D),document.addEventListener("mouseup",q),()=>{document.removeEventListener("selectionchange",z),document.removeEventListener("mousedown",D),document.removeEventListener("mouseup",q)}),[]);let P=(0,b.toolbarPlugin)(),B=(0,m.searchPlugin)(),{Toolbar:X}=P,$=(0,i.useMemo)(()=>[P,B],[B,P]),A=(0,i.useRef)(null),H=(0,i.useRef)({x:0,y:0}),[O,Y]=(0,i.useState)({x:0,y:0,width:0,height:0}),[W,V]=(0,i.useState)(!1),[Z,G]=(0,i.useState)(!1),J=(0,i.useCallback)(e=>{if(!N||!A.current||Z)return;document.body.style.userSelect="none";let t=A.current.getBoundingClientRect();H.current={x:e.clientX-t.left,y:e.clientY-t.top},Y({x:e.clientX-t.left,y:e.clientY-t.top,width:0,height:0}),V(!0)},[N,Z]),K=(0,i.useCallback)(e=>{if(!W||!A.current)return;let t=A.current.getBoundingClientRect(),n=e.clientX-t.left,r=Math.max(e.clientY-t.top,0);Y({x:Math.round(Math.min(n,H.current.x)),y:Math.round(Math.min(r,H.current.y)),width:Math.round(Math.abs(n-H.current.x)),height:Math.round(Math.abs(r-H.current.y))})},[W]),Q=(0,i.useCallback)(async()=>{document.body.style.userSelect="auto";let e=document.querySelector(".rpv-core__viewer");V(!1),e?(G(!0),y()(e,{...O}).then(e=>{(0,l.Nd)({body:{base64:e.toDataURL()},query:{createMode:"image"},param:{type:"page"}}).then(e=>{var t;e.error||U((null===(t=e.data)||void 0===t?void 0:t.uuid)||"","image")})}).finally(()=>{R(!1),G(!1)})):R(!1)},[W,O,Z]);(0,i.useEffect)(()=>(W&&A.current&&(document.addEventListener("mousemove",K),document.addEventListener("mouseup",Q)),()=>{document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",Q)}),[W,K,Q]);let ee=(0,i.useMemo)(()=>{let e={pos:"absolute",bgColor:"rgba(0,0,0,.35)"},t={...e,top:0,left:0,bottom:0,width:"".concat(O.x,"px")},n={...e,top:0,right:0,bottom:0,width:"calc(100% - ".concat(O.x+O.width,"px)")},i={...e,top:0,left:"".concat(O.x,"px"),right:"calc(100% - ".concat(O.x+O.width,"px)"),height:"".concat(O.y,"px")},l={...e,bottom:0,left:"".concat(O.x,"px"),right:"calc(100% - ".concat(O.x+O.width,"px)"),height:"calc(100% - ".concat(O.y+O.height,"px)")},s={position:"absolute",top:"".concat(O.y,"px"),left:"".concat(O.x,"px"),width:"".concat(O.width,"px"),height:"".concat(O.height,"px"),alignItems:"center",justifyContent:"center",backgroundImage:"linear-gradient(90deg, #1777ff 50%, transparent 0), linear-gradient(90deg, #1777ff 50%, transparent 0), linear-gradient(0deg, #1777ff 50%, transparent 0), linear-gradient(0deg, #1777ff 50%, transparent 0)",backgroundRepeat:"repeat-x, repeat-x, repeat-y, repeat-y",backgroundSize:"10px 1px,10px 1px,1px 10px,1px 10px",backgroundPosition:"0 0,100% 100%,0 100%,100% 0",animation:"border-dance 0.5s infinite linear"};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.xu,{...i}),(0,r.jsx)(o.xu,{...l}),(0,r.jsx)(o.xu,{...t}),(0,r.jsx)(o.xu,{...n}),(0,r.jsx)(v.k,{...s,children:Z&&(0,r.jsx)(j.$,{})})]})},[O.width,O.x,O.y,O.height,W,Z]);return(0,r.jsx)(o.xu,{w:"full",h:"calc(100vh - ".concat(d.rt,")"),className:"pdfView-context",children:(0,r.jsxs)(f.eh,{direction:"horizontal",children:[(0,r.jsx)(f.s_,{defaultSize:s[0],children:(0,r.jsxs)(v.k,{h:"full",direction:"column",children:[(0,r.jsxs)(v.k,{w:"full",px:5,py:4,justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #969696",fontSize:"14px",lineHeight:"20px",children:[(0,r.jsxs)(v.k,{px:.5,alignItems:"center",fontFamily:"var(--font-content)",children:[(0,r.jsx)(C.ActionSelectTextIcon,{mr:1}),"Select Text Below To Create"]}),(0,r.jsx)(w.z,{leftIcon:(0,r.jsx)(C.ActionScreenshotIcon,{}),rounded:10,fontFamily:"var(--font-content)",color:"#4335DE",border:"1px solid #4335DE",bgColor:"white",_hover:{},onClick:()=>{R(!N)},children:"Screenshot to Slide"}),(0,r.jsx)(v.k,{px:.5,children:(0,r.jsx)(X,{children:e=>{let{ShowSearchPopover:t,Zoom:n,ZoomIn:o,ZoomOut:i}=e;return(0,r.jsxs)(v.k,{gap:.5,children:[(0,r.jsx)(i,{}),(0,r.jsx)(n,{}),(0,r.jsx)(o,{}),(0,r.jsx)(t,{})]})}})})]}),(0,r.jsxs)(v.k,{h:"full",pos:"relative",flex:"1",overflow:"auto",children:[N?(0,r.jsx)(o.xu,{w:"full",h:"full",pos:"absolute",left:"0",right:"0",className:"pdf-cropper-view",zIndex:"2",cursor:"crosshair",borderStyle:"solid",borderWidth:"3px",borderColor:"#00bff6",children:(0,r.jsx)(o.xu,{pos:"relative",w:"full",h:"full",ref:A,onMouseDown:J,children:W||Z?(0,r.jsx)(r.Fragment,{children:ee}):null})}):null,t.pdfFileUrl?(0,r.jsxs)(o.xu,{w:"full",h:"full",pos:"relative",className:"pdf-viwer",children:[(0,r.jsx)(S.h,{children:(0,r.jsx)(v.k,{zIndex:"5000",position:"fixed",visibility:"hidden",rounded:"10px",bgColor:"#fff",id:"selection-context-menu",boxShadow:"lg",children:(0,r.jsx)(v.k,{direction:"column",p:2,rounded:10,alignItems:"center",justifyContent:"center",color:"#050505",backgroundColor:"white",boxShadow:"5px 5px 5px 1px rgba(5, 5, 5, 0.20)",children:(0,r.jsxs)(v.k,{py:2,px:3,rounded:10,gap:1,cursor:"pointer",alignItems:"center",_hover:{bg:"#FEF8EB"},onMouseDown:async()=>{let e=window.getSelection(),t=(null==e?void 0:e.toString())||"";t&&U(t)},children:[(0,r.jsx)(M.poH,{}),"Create New Slide"]})})})}),(0,r.jsx)(h.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.4.120/build/pdf.worker.min.js",children:(0,r.jsx)(h.Viewer,{fileUrl:t.pdfFileUrl,defaultScale:h.SpecialZoomLevel.ActualSize,plugins:$})})]}):(0,r.jsx)(k.M,{w:"full",children:(0,r.jsx)(j.$,{})})]})]})}),(0,r.jsx)(f.OT,{className:"w-0.5 bg-gray-400"}),(0,r.jsx)(f.s_,{defaultSize:s[1],children:(0,r.jsxs)(v.k,{h:"full",direction:"column",children:[(0,r.jsx)(v.k,{w:"full",px:5,py:4,justifyContent:"flex-end",alignItems:"center",borderBottom:"1px solid #969696",fontSize:"14px",lineHeight:"20px",children:(0,r.jsx)(p.df,{dataItem:t,buttonProps:{size:"sm",color:"#4335DE",border:"1px solid #4335DE",bgColor:"white",_hover:{}}})}),(0,r.jsx)(o.xu,{w:"full",h:"full",overflow:"auto",px:3,py:2.5,ref:x,children:(0,r.jsxs)(v.k,{maxW:"860px",direction:"column",mx:"auto",gap:2.5,children:[(0,r.jsx)(I.y,{dataItem:t}),g&&(0,r.jsx)(o.xu,{w:"full",children:(0,r.jsx)(o.xu,{"data-body":"slide-loading",rounded:"8px",overflow:"hidden",children:(0,r.jsx)(E.o,{ratio:_.hM,bgColor:"gray.100",children:(0,r.jsx)(k.M,{children:(0,r.jsx)(j.$,{})})})})})]})})]})})]})})},T=()=>{(0,x.R)(e=>{e||(window.location.href="/login?redirectUrl=".concat(encodeURIComponent(window.location.href)))});let e=(0,c.useRouter)(),[t,n]=(0,i.useState)(!1),[s,h]=(0,i.useState)({}),[f,m]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{n(!0)},[]),(0,i.useEffect)(()=>{var n;if(!t||!(null==e?void 0:null===(n=e.query)||void 0===n?void 0:n.presentationId))return;let r=async()=>{var t;let n=await (0,l.sD)({param:{openId:(null==e?void 0:null===(t=e.query)||void 0===t?void 0:t.presentationId)||""},query:{handleType:"filePreview"}});if(n.error){console.error(n.error),e.replace(_.pE);return}h(n.data.presentation)};r().catch(e=>console.log(e))},[t,e]),(0,i.useEffect)(()=>{t&&s&&s.pdfFileIsShow&&!s.pdfFileUrl&&!f&&(m(!0),(0,l.q$)({param:{openId:s.openId},body:{handleType:"field",field:"pdfFileUuid"}}).then(e=>{if(m(!1),e.error){console.error(e.error);return}s.pdfFileUrl=e.data.presentation.pdfFileUrl,h(s)}))},[t,s]),t&&s.pageList)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:s.name})}),(0,r.jsx)(o.xu,{pos:"relative",minH:"100vh",display:["none","block"],children:(0,r.jsxs)(o.xu,{pos:"relative",zIndex:"2",pb:s.pdfFileUrl?0:d.rt,children:[(0,r.jsx)(d.zC,{dataItem:s,setDataItem:h,leftTabType:"preview",rightButtons:[{buttonType:p.L$.Download,buttonText:"Download Presentation"},{buttonType:p.L$.Present,buttonProps:{isSmallIcon:!0}}]}),(0,r.jsx)(o.xu,{h:d.rt}),(0,r.jsx)(F,{dataItem:s,setDataItem:h})]})}),(0,r.jsx)(o.xu,{display:["block","none"],children:"For the best experience, please visit our website on a desktop or laptop computer."})]}):(0,r.jsx)(u.E,{})};var N=T},93414:function(){},70172:function(){},2001:function(){},33779:function(){},82258:function(){}},function(e){e.O(0,[260,3874,6556,4577,5443,5272,8371,7270,143,1930,8216,2243,9774,2888,179],function(){return e(e.s=92027)}),_N_E=e.O()}]);